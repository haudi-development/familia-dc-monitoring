# 開発履歴

## 2025年7月22日

### Phase 1: 初期セットアップとコア機能

1. **プロジェクトセットアップ**
   - Next.js 14 (App Router)のセットアップ
   - TypeScript設定
   - Tailwind CSS v4導入
   - 必要なライブラリインストール（Prisma, Lucide React, Recharts等）

2. **基本レイアウト実装**
   - サイドバーコンポーネント作成
   - ヘッダーコンポーネント作成
   - ダッシュボードレイアウト実装

3. **データ構造設計**
   - TypeScript型定義（DataCenter, Room, Rack, Sensor）
   - ダミーデータ生成機能（340センサー分）
   - リアルな温度パターン実装

### Phase 2: ラック配置図の実装

1. **初期実装（RackLayout）**
   - 17列×10行のグリッド表示
   - ヒートマップカラー表示
   - ホバー時の詳細表示

2. **改善版（RackLayoutV2）**
   - 参考画像に基づく詳細な配置
   - PoE Hub、ルーターの表示
   - グループ化表示

3. **シンプル版（RackLayoutSimple）**
   - 明確な列ラベル（A-Q）と行番号（1-10）
   - 列間隔の調整（行間隔の3倍→5倍）
   - ツールチップ位置の自動調整

### Phase 3: マルチDC/マルチルーム対応

1. **DC管理ページ**
   - データセンター一覧表示
   - 各DCの統計情報
   - ルーム一覧へのナビゲーション

2. **ルーム管理ページ**
   - ルーム一覧表示
   - 各ルームの統計情報
   - ルーム詳細へのリンク

3. **ダッシュボード改善**
   - DC/ルーム選択ドロップダウン
   - 選択に応じたデータ切り替え

### Phase 4: 吸気側/排気側対応

1. **センサー位置の再定義**
   - front/back → intake/exhaust
   - 通路配置に基づく正確な位置判定
   - リアルな温度差の実装（排気側は3-5°C高い）

2. **ヒートマップ分割表示（RackLayoutDual）**
   - 各ラックを左右に分割
   - 吸気側と排気側を別々の色で表示
   - 温度差の表示

3. **UI改善**
   - モーダル背景の透明度調整
   - 吸気側を青系、排気側を赤系で表示
   - 「吸」「排」文字の削除（要望に基づく）

## 技術的な決定事項

### Tailwind CSS v4対応
- `tailwind.config.ts`は不要（v4では自動設定）
- CSS変数は`@theme`ディレクティブで定義
- クラス名でCSS変数を直接参照（`bg-[var(--color-primary)]`）

### Hydrationエラー対策
- 初期状態は空配列で定義
- `useEffect`内でクライアントサイドのみデータ生成
- ローディング状態の実装

### レイアウト調整
- ヘッダーとコンテンツの間隔: `pt-24`（96px）
- ラック列間隔: `gap-x-5`（行間隔の5倍）
- グリッド配置の正確な位置合わせ

## 今後の実装予定

1. **データ管理機能**
   - センサーデータの履歴表示
   - グラフ表示
   - CSVエクスポート

2. **アラート機能**
   - 閾値設定
   - 通知機能
   - アラート履歴

3. **データベース統合**
   - Prismaセットアップ
   - PostgreSQL接続
   - データ永続化

4. **MQTT統合**
   - リアルタイムデータ受信
   - WebSocket実装
   - データ検証